"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[992],{3621:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"seq-db/internal/fractions","title":"Factions","description":"See also","source":"@site/i18n/ru/docusaurus-plugin-content-docs/current/seq-db/internal/fractions.md","sourceDirName":"seq-db/internal","slug":"/seq-db/internal/fractions","permalink":"/seq-db-docs/ru/seq-db/internal/fractions","draft":false,"unlisted":false,"editUrl":"https://github.com/ozontech/seq-db/tree/main/website/docs/docs/seq-db/internal/fractions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Fraction Cache (.frac-cache)","permalink":"/seq-db-docs/ru/seq-db/internal/frac-cache"},"next":{"title":"How search request parsing works","permalink":"/seq-db-docs/ru/seq-db/internal/parser"}}');var s=i(4848),r=i(8453);const o={},a="Factions",c={},d=[{value:"See also",id:"see-also",level:2},{value:"Active fraction",id:"active-fraction",level:3},{value:"Sealed fraction",id:"sealed-fraction",level:3}];function l(e){const n={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"factions",children:"Factions"})}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Fractions"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/seq-db-docs/ru/seq-db/internal/format-docs-meta-file",children:"Format of Documents and Metadata File"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/seq-db-docs/ru/seq-db/internal/format-index-file",children:"Format of Index File of Sealed Fraction"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"In terms of seq-db fraction is a data store unit. There are two types of fraction:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Active fraction. A fraction to which documents can be added. Documents and corresponding metadata are saved to disk, while an index of documents is stored in memory."}),"\n",(0,s.jsx)(n.li,{children:"Sealed fraction. Immutable read-only fraction. When the size of an active fraction exceeds a certain threshold, its index is written to disk and the fraction becomes sealed."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"active-fraction",children:"Active fraction"}),"\n",(0,s.jsx)(n.p,{children:"Active fraction consists of 2 files:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Document file. It consists of a sequence of blocks. Each block contains all documents from the corresponding bulk request."}),"\n",(0,s.jsx)(n.li,{children:"Metafile. Like a document file, it consists of a sequence of blocks with document metadata from the corresponding bulk request."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The index to the documents on disk is stored in memory. In the event of an abnormal termination, seq-db reads the docfile and metafile from disk during service initialization and restores the index in memory."}),"\n",(0,s.jsx)(n.p,{children:"This process of restoring the index in memory is called Replaying (see Active.ReplayBlocks() method)"}),"\n",(0,s.jsx)(n.p,{children:"In the event of a regular shutdown of the seq-db service, the active fraction is sealed if its size exceeds 20% of the maximum allowable size of the active fraction."}),"\n",(0,s.jsx)(n.p,{children:"Regular sealing also occurs when the active fraction exceeds the maximum size. Then the active fraction is sealed and a new active fraction is created into which new incoming documents begin to be written."}),"\n",(0,s.jsx)(n.h3,{id:"sealed-fraction",children:"Sealed fraction"}),"\n",(0,s.jsx)(n.p,{children:"The sealed fraction consists of 2 files:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Document file. The same as for the active faction."}),"\n",(0,s.jsx)(n.li,{children:"Index file. This is a serialized representation of the index of the active faction."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Sealing is the process of serializing the in-memory index of the active faction into an index file."}),"\n",(0,s.jsxs)(n.p,{children:["The structure of the index file is complex and is described ",(0,s.jsx)(n.a,{href:"/seq-db-docs/ru/seq-db/internal/format-index-file",children:"here"})]}),"\n",(0,s.jsx)(n.p,{children:"There is a mechanism for rotating sealed fractions."}),"\n",(0,s.jsx)(n.p,{children:"When the total dataset size exceeds the specified threshold, the oldest fractions will be removed to keep the dataset size within bounds."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(6540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);