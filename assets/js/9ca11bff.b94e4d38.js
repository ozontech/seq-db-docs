"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[612],{412:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"seq-db/seq-ql","title":"seq-ql","description":"Full-text Search","source":"@site/docs/seq-db/05-seq-ql.md","sourceDirName":"seq-db","slug":"/seq-db/seq-ql","permalink":"/seq-db-docs/seq-db/seq-ql","draft":false,"unlisted":false,"editUrl":"https://github.com/ozontech/seq-db/tree/main/website/docs/docs/seq-db/05-seq-ql.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"seq-ql"},"sidebar":"docs","previous":{"title":"Index types and mappings","permalink":"/seq-db-docs/seq-db/index-types"},"next":{"title":"Long term stores","permalink":"/seq-db-docs/seq-db/long-term-store"}}');var i=n(4848),r=n(8453);const d={id:"seq-ql"},c="seq-ql",t={},a=[{value:"Full-text Search",id:"full-text-search",level:2},{value:"String Literals",id:"string-literals",level:3},{value:"Logical Operators",id:"logical-operators",level:2},{value:"Wildcards",id:"wildcards",level:2},{value:"Filter <code>range</code>",id:"filter-range",level:2},{value:"Filter <code>in</code>",id:"filter-in",level:2},{value:"Pipes",id:"pipes",level:2},{value:"<code>fields</code> pipe",id:"fields-pipe",level:4},{value:"Comments",id:"comments",level:2},{value:"Query Optimization Recommendations for seq-ql",id:"query-optimization-recommendations-for-seq-ql",level:2},{value:"Reducing Returned Fields",id:"reducing-returned-fields",level:3}];function o(e){const s={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"seq-ql",children:"seq-ql"})}),"\n",(0,i.jsx)(s.h2,{id:"full-text-search",children:"Full-text Search"}),"\n",(0,i.jsxs)(s.p,{children:["Full-text search in seq-ql allows filtering results based on document tokens.\nQueries can include exact phrases or keywords separated by spaces.\nThe behavior depends on the index type; more details on token formation can be found in\nthe ",(0,i.jsx)(s.a,{href:"/seq-db-docs/seq-db/index-types",children:"index types"})," documentation.\nWhen performing a full-text search, the system automatically selects results that match the specified text."]}),"\n",(0,i.jsxs)(s.p,{children:["Search queries are case-insensitive by default.\nTo change this behavior, use the ",(0,i.jsx)(s.code,{children:"--case-sensitive"})," flag, but it affects only new documents."]}),"\n",(0,i.jsx)(s.h3,{id:"string-literals",children:"String Literals"}),"\n",(0,i.jsx)(s.p,{children:"In seq-ql, different syntaxes can be used for string literals when specifying values in filters."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Without quotes"})," \u2014 can be used if the field or value consists of a single word without spaces or special\ncharacters:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"key: value\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)(s.strong,{children:["Single quotes (",(0,i.jsx)(s.code,{children:"'"}),")"]})," \u2014 allow specifying fields or values containing spaces and special characters:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"key: 'value with spaces'\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Inside quotes, escape sequences can be used, which must always start with the ",(0,i.jsx)(s.code,{children:"\\"})," character. Example:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"# Equivalent to search: key:\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\nkey: '\\u0437\\u043d\\u0430\\u0447\\u0435\\u043d\\u0438\\u0435'\n"})}),"\n",(0,i.jsx)(s.p,{children:"Supported escape sequences:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.a,{href:"#wildcards",children:"Wildcard"})," characters \u2013 ",(0,i.jsx)(s.code,{children:"\\*"})]}),"\n",(0,i.jsxs)(s.li,{children:["Quotes and slashes \u2013 ",(0,i.jsx)(s.code,{children:'\\"'}),", ",(0,i.jsx)(s.code,{children:"\\'"}),", ",(0,i.jsx)(s.code,{children:"\\\\"})]}),"\n",(0,i.jsxs)(s.li,{children:["Unicode \u2013 ",(0,i.jsx)(s.code,{children:"\\u"})," for 4-byte characters, ",(0,i.jsx)(s.code,{children:"\\U"})," for 8-byte characters"]}),"\n",(0,i.jsxs)(s.li,{children:["Control characters \u2013 ",(0,i.jsx)(s.code,{children:"\\n"}),", ",(0,i.jsx)(s.code,{children:"\\r"})]}),"\n",(0,i.jsxs)(s.li,{children:["Byte \u2013 ",(0,i.jsx)(s.code,{children:"\\x"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)(s.strong,{children:["Double quotes (",(0,i.jsx)(s.code,{children:'"'}),")"]})," \u2014 similar to single quotes but allow single quotes inside the string:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:'"key": "value with \'quotes\'"\n'})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)(s.strong,{children:["Backticks (",(0,i.jsx)(s.code,{children:"`"}),")"]})," \u2014 used for fields and values containing both single and double quotes:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"`key with space`:`value with \"double\" and 'single' quotes`\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Important: backticks do not escape ",(0,i.jsx)(s.a,{href:"#wildcards",children:"wildcard"})," and escape sequences, so the following examples\nare equivalent:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"key: `\\n` or key: `*`\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"key: '\\\\n' or key: '\\*'\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"logical-operators",children:"Logical Operators"}),"\n",(0,i.jsxs)(s.p,{children:["seq-ql supports logical operators for more precise search filtering.\nThe operators ",(0,i.jsx)(s.code,{children:"and"}),", ",(0,i.jsx)(s.code,{children:"or"}),", and ",(0,i.jsx)(s.code,{children:"not"})," allow combining and refining queries:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"and"})," \u2014 requires both conditions to be true."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"or"})," \u2014 returns results if at least one condition is met."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"not"})," \u2014 excludes results that match a specific condition."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Examples:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"message:error and level:critical\nmessage:login or message:logout\nnot level:debug\n"})}),"\n",(0,i.jsx)(s.h2,{id:"wildcards",children:"Wildcards"}),"\n",(0,i.jsx)(s.p,{children:"Wildcards in seq-ql allow for partial matching in search.\nThe language supports the following symbols:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"*"})," \u2014 replaces any number of characters."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["These symbols can be used to search within tokens or parts of tokens.\nFor example, a query on the ",(0,i.jsx)(s.a,{href:"/seq-db-docs/seq-db/index-types#keyword",children:"keyword"})," index ",(0,i.jsx)(s.code,{children:"source_type:access*"})," will match all documents starting\nwith ",(0,i.jsx)(s.code,{children:"access"}),"."]}),"\n",(0,i.jsxs)(s.h2,{id:"filter-range",children:["Filter ",(0,i.jsx)(s.code,{children:"range"})]}),"\n",(0,i.jsx)(s.p,{children:"seq-ql enables range filtering to limit data by value, which is particularly useful for numeric fields such as sizes or\ntimestamps.\nRanges are specified using square or round brackets:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"[a, b]"})," \u2014 includes both ends of the range."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"(a, b)"})," \u2014 excludes both ends of the range."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Example of range usage:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"bytes:(100, 1000]\nbytes:[100, 1000)\n"})}),"\n",(0,i.jsxs)(s.h2,{id:"filter-in",children:["Filter ",(0,i.jsx)(s.code,{children:"in"})]}),"\n",(0,i.jsxs)(s.p,{children:["seq-ql allows using the ",(0,i.jsx)(s.code,{children:"in"})," filter to filter a list of tokens.\nThe syntax for full-text search is the same as in ",(0,i.jsx)(s.a,{href:"#full-text-search",children:"full-text search"})," and supports all types of string\nliterals.\nSearch tokens must be separated by commas."]}),"\n",(0,i.jsxs)(s.p,{children:["Example usage of ",(0,i.jsx)(s.code,{children:"in"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"level:error and k8s_namespace:in(default, kube-system) and k8s_pod:in(kube-proxy-*, kube-apiserver-*, kube-scheduler-*)\n\ntrace_id:in(123e4567-e89b-12d3-a456-426655440000, '123e4567-e89b-12d3-a456-426655440001', \"123e4567-e89b-12d3-a456-426655440002\",`123e4567-e89b-12d3-a456-426655440003`)\n"})}),"\n",(0,i.jsx)(s.h2,{id:"pipes",children:"Pipes"}),"\n",(0,i.jsx)(s.p,{children:"Pipes in seq-ql are used to sequentially process data.\nPipes enable data transformation, enrichment, filtering, aggregation, and formatting of results."}),"\n",(0,i.jsxs)(s.h4,{id:"fields-pipe",children:[(0,i.jsx)(s.code,{children:"fields"})," pipe"]}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"fields"})," pipe allows removing unnecessary fields from documents in the output.\nThis is useful when only specific fields are needed, especially when exporting large datasets to reduce network load."]}),"\n",(0,i.jsxs)(s.p,{children:["The listed fields may not be present in the ",(0,i.jsx)(s.a,{href:"/seq-db-docs/seq-db/index-types",children:"mapping"}),", and their absence does not affect the performance of\nthe ",(0,i.jsx)(s.code,{children:"fields"})," pipe."]}),"\n",(0,i.jsx)(s.p,{children:"Example:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"source_type:access* | fields user, KB\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In the final result, each document will contain only the ",(0,i.jsx)(s.code,{children:"user"})," and ",(0,i.jsx)(s.code,{children:"KB"})," fields."]}),"\n",(0,i.jsxs)(s.p,{children:["To remove only specific fields, use the ",(0,i.jsx)(s.code,{children:"except"})," keyword:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"source_type:access* | fields except payload, cookies\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In this example, the ",(0,i.jsx)(s.code,{children:"payload"})," and ",(0,i.jsx)(s.code,{children:"cookies"})," fields will be excluded from the result."]}),"\n",(0,i.jsx)(s.h2,{id:"comments",children:"Comments"}),"\n",(0,i.jsxs)(s.p,{children:["Comments are user-provided text that will be ignored when executing a query.",(0,i.jsx)(s.br,{}),"\n","Comments must start with the ",(0,i.jsx)(s.code,{children:"#"})," keyword, followed by the comment text, which must end with a newline character."]}),"\n",(0,i.jsx)(s.p,{children:"Example:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"# Exporting debug logs for file.d\nservice: file-d and message: 'Event sample' and level: error # Filtering file.d logs by \"error\" level\n| fields event # Returning the 'event' field to retrieve all debug logs for file.d\n"})}),"\n",(0,i.jsx)(s.h2,{id:"query-optimization-recommendations-for-seq-ql",children:"Query Optimization Recommendations for seq-ql"}),"\n",(0,i.jsx)(s.p,{children:"Optimizing seq-ql queries enables efficient data processing and faster access to results, reducing system load."}),"\n",(0,i.jsx)(s.h3,{id:"reducing-returned-fields",children:"Reducing Returned Fields"}),"\n",(0,i.jsxs)(s.p,{children:["Specify only the fields you need to reduce data volume and accelerate query processing.\nUse the ",(0,i.jsx)(s.code,{children:"fields"})," formatting pipe to select only important fields:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-seq-ql",children:"source_type:access* | fields KB, status, timestamp\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In this example, the final result includes only ",(0,i.jsx)(s.code,{children:"KB"}),", ",(0,i.jsx)(s.code,{children:"status"}),", and ",(0,i.jsx)(s.code,{children:"timestamp"}),", reducing output time."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>c});var l=n(6540);const i={},r=l.createContext(i);function d(e){const s=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),l.createElement(r.Provider,{value:s},e.children)}}}]);